<query-editor-row query-ctrl="ctrl" class="generic-datasource-query-row" has-text-edit-mode="false">
  <div class="gf-form-inline">

    <!-- first select whether we want a single exported metric or a new node -->
    <div class="gf-form max-width-8">
      <select class="gf-form-input"
        ng-model="ctrl.target.type"
        ng-options="f as f for f in ['predefined', 'new']">
      </select>
    </div>

    <div class="gf-form" ng-if="ctrl.target.type == 'predefined'">
      <div class="gf-form max-width-30">
        stream:<gf-form-dropdown model="ctrl.target.node"
          lookup-text="true"
          get-options="ctrl.getOptions('nodes', $query)"
          on-change="ctrl.onChangeInternal()">
        </gf-form-dropdown>
      </div>

      <div class="gf-form max-width-20">
        data:<gf-form-dropdown model="ctrl.target.data_field"
          lookup-text="true"
          get-options="ctrl.getOptions('fields', $query)"
          on-change="ctrl.onChangeInternal()">
        </gf-form-dropdown>
      </div>
    </div>

    <div class="gf-form" ng-if="ctrl.target.type == 'predefined'">
      <div class="gf-form max-width-30">
        parent:<gf-form-dropdown model="ctrl.target.parent"
          lookup-text="true"
          get-options="ctrl.getOptions('nodes', $query)"
          on-change="ctrl.onChangeInternal()">
        </gf-form-dropdown>
      </div>

      <div class="gf-form max-width-20">
        query: blahblah
      </div>
    </div>

    <div class="gf-form max-width-10">
      consol:<gf-form-dropdown model="ctrl.target.consolidation"
        lookup-text="true"
        get-options="ctrl.getConsolidation()"
        on-change="ctrl.onChangeInternal()">
      </gf-form-dropdown>
    </div>
  </div>
</query-editor-row>
